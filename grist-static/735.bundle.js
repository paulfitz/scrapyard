"use strict";(self.webpackChunkgrist_core=self.webpackChunkgrist_core||[]).push([[735],{11104:(e,t,n)=>{n.r(t),n.d(t,{ACIndexImpl:()=>d,buildHighlightedDom:()=>m,highlightNone:()=>c,normalizeText:()=>r});var s=n(83277);const o=n(41469),i=n(8308),l=n(95030);function r(e){return i(e).trim().toLowerCase()}const a=/[\s!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~]+/,c=e=>[e];class d{constructor(e,t=50,n=!1){this._maxResults=t,this._keepOrder=n,this._allItems=e.slice(0);const o=[];for(let e=0;e<this._allItems.length;e++){const t=this._allItems[e].cleanText.split(a).filter((e=>e));for(let n=0;n<t.length;n++)o.push({word:t[n],index:e,pos:n})}o.sort(((e,t)=>(0,s.localeCompare)(e.word,t.word))),this._words=o}search(e){const t=r(e),n=t.split(a).filter((e=>e)),i=new Map;if(n.length>0){for(let e=0;e<n.length;e++){const t=n[e];for(const[n,s]of this._findOverlaps(t,e))i.set(n,(i.get(n)||0)+s)}for(const[e,n]of i)this._allItems[e].cleanText.startsWith(t)&&i.set(e,n+1)}const l=Array.from(i).sort(((e,t)=>(0,s.nativeCompare)(t[1],e[1])||(0,s.nativeCompare)(e[0],t[0]))).slice(0,this._maxResults),d=l.map((([e,t])=>e));for(let e=0;e<this._allItems.length&&d.length<this._maxResults;e++)this._allItems[e].cleanText&&!i.has(e)&&d.push(e);this._keepOrder&&d.sort(s.nativeCompare);const m=d.map((e=>this._allItems[e]));if(!t)return{items:m,highlightFunc:c,selectIndex:-1};const u=p.bind(null,n);let h=l.length>0?d.indexOf(l[0][0]):-1;return h>=0&&!function(e,t,n){if(e.cleanText.startsWith(t))return!0;const s=new RegExp(n.map((e=>"\\b"+o(e))).join(".*")),i=e.cleanText.split(a).join(" ");return s.test(i)}(m[h],t,n)&&(h=-1),{items:m,highlightFunc:u,selectIndex:h}}_findOverlaps(e,t){const n=(0,s.sortedIndex)(this._words,{word:e},((e,t)=>(0,s.localeCompare)(e.word,t.word))),o=new Map;for(const s of[1,-1]){let i=e,l=n+(s>0?0:-1);for(;i&&l>=0&&l<this._words.length;){for(;l>=0&&l<this._words.length;l+=s){const n=this._words[l];if(!n.word.startsWith(i))break;const s=i.length+(n.word===e?1:0)+Math.pow(2,-(t+n.pos));s>=(o.get(n.index)||0)&&o.set(n.index,s)}i=i.slice(0,-1)}}return o}}function m(e,t,n){return e?t(e).map(((e,t)=>t%2?n(e):e)):e}const u=new RegExp(`(${a.source})`);function p(e,t){const n=t.split(u),s=[""];for(let t=0;t<n.length;t+=2){const o=n[t],r=n[t+1]||"",a=h(i(o).toLowerCase(),e);if(0===a)s[s.length-1]+=o+r;else{const e=l(o,"");s.push(e.slice(0,a).join(""),e.slice(a).join("")+r)}}return s}function h(e,t){return t.reduce(((t,n)=>Math.max(t,function(e,t){let n=0;for(;n<e.length&&e[n]===t[n];)++n;return n}(e,n))),0)}},84462:(e,t,n)=>{n.d(t,{H:()=>m,R:()=>c});var s=n(11104),o=n(6632),i=n(29922),l=n(7454),r=n(1370),a=n(18099);function c(e,t,...n){const{acIndex:i,valueObs:l,save:c}=t,b=a.Holder.create(e);let g;const f=()=>!b.isEmpty(),v=()=>b.isEmpty()&&o.Autocomplete.create(b,g,$),x=()=>{b.clear(),g.blur()},y=()=>{g.value=l.get(),x()},_=async()=>{await I()||y()},w=()=>{f()?_().catch((()=>{})):v()},I=async()=>{var e;const t=null==(e=b.get())?void 0:e.getSelectedItem();t&&(g.value=t.value),g.disabled=!0;try{return await c(g.value,t),x(),!0}catch(e){return!1}finally{g.disabled=!1}},$={menuCssClass:`${r.menuCssClass} test-acselect-dropdown`,search:async e=>i.search(e),renderItem:(e,t)=>m((0,s.buildHighlightedDom)(e.label,t,h)),getItemText:e=>e.value,onClick:I};return d(g=u({type:"text"},a.dom.prop("value",l),a.dom.on("focus",((e,t)=>t.select())),a.dom.on("blur",_),a.dom.prop("disabled",(e=>!!t.disabled&&e(t.disabled))),a.dom.onKeyDown({Escape:y,Enter:w,ArrowDown:v,Tab:I}),a.dom.on("input",v)),a.dom.on("mousedown",(e=>{var n;e.preventDefault(),(null==(n=t.disabled)?void 0:n.get())||(f()||g.focus(),w())})),p("Dropdown"),...n)}const d=(0,a.styled)("div",`\n  position: relative;\n  width: 100%;\n  height: 30px;\n  color: ${i.theme.selectButtonFg};\n  --icon-color: ${i.theme.selectButtonFg};\n`),m=(0,a.styled)("li",`\n  color: ${i.theme.menuItemFg};\n  display: block;\n  white-space: pre;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  outline: none;\n  padding: var(--weaseljs-menu-item-padding, 8px 24px);\n  cursor: pointer;\n\n  &.selected {\n    background-color: ${i.theme.menuItemSelectedBg};\n    color:            ${i.theme.menuItemSelectedFg};\n  }\n`),u=(0,a.styled)("input",`\n  color: ${i.theme.inputFg};\n  background-color: ${i.theme.inputBg};\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  height: 100%;\n  width: 100%;\n  padding: 0 6px;\n  outline: none;\n  border: 1px solid ${i.theme.inputBorder};\n  border-radius: 3px;\n  cursor: pointer;\n  line-height: 16px;\n  cursor: pointer;\n\n  &:disabled {\n    color: ${i.theme.inputDisabledFg};\n    background-color: ${i.theme.inputDisabledBg};\n  }\n  &:focus {\n    cursor: initial;\n    outline: none;\n    box-shadow: 0px 0px 2px 2px ${i.theme.inputFocus};\n  }\n  &::placeholder {\n    color: ${i.theme.inputPlaceholderFg};\n  }\n`),p=(0,a.styled)(l.icon,"\n  position: absolute;\n  right: 6px;\n  top: calc(50% - 8px);\n"),h=(0,a.styled)("span",`\n  color: ${i.theme.autocompleteMatchText};\n  .selected > & {\n    color: ${i.theme.autocompleteSelectedMatchText};\n  }\n`)},6632:(e,t,n)=>{n.r(t),n.d(t,{Autocomplete:()=>g,attachMouseOverOnMove:()=>x,defaultPopperOptions:()=>f,findAncestorChild:()=>v});var s=n(84418),o=n(92769),i=n(18099),l=n(20106),r=n(21467),a=Object.defineProperty,c=Object.defineProperties,d=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,h=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const b=n(7531);class g extends i.Disposable{constructor(e,t){var n;super(),this._triggerElem=e,this._options=t,this._selectedIndex=-1,this._selected=null,this._items=this.autoDispose((0,i.obsArray)([]));const o=y(this._menuContent=(0,r.cssMenu)({class:t.menuCssClass||""},i.dom.forEach(this._items,(e=>t.renderItem(e,this._highlightFunc))),i.dom.style("min-width",e.getBoundingClientRect().width+"px"),i.dom.on("mouseleave",(e=>this._setSelected(-1,!0))),i.dom.on("click",(e=>{this._setSelected(this._findTargetItem(e.target),!0),t.onClick&&t.onClick()}))),i.dom.on("mousedown",(e=>e.preventDefault())));this._mouseOver=x(this._menuContent,(e=>this._setSelected(this._findTargetItem(e.target),!0))),this.autoDispose((0,i.onKeyElem)(e,"keydown",{ArrowDown:()=>this._setSelected(this._getNext(1),!0),ArrowUp:()=>this._setSelected(this._getNext(-1),!0)})),this.search(),this.autoDispose(i.dom.onElem(e,"input",(()=>this.search())));var l,a;(null!=(l=e,n="string"==typeof(a=void 0===t.attach?document.body:t.attach)?l.closest(a):a||l.parentNode)?n:document.body).appendChild(o),this.onDispose((()=>{i.dom.domDispose(o),o.remove()}));const c=b({},f,t.popperOptions);this._popper=(0,s.fi)(e,o,c),this.onDispose((()=>this._popper.destroy()))}getSelectedItem(){return this._items.get()[this._selectedIndex]}search(e){this._updateChoices(this._triggerElem.value,e).catch(o.reportError)}_setSelected(e,t){const n=this._menuContent.children[e]||null,s=this._selected;if(n!==s){const e=this._options.selectedCssClass||"selected";s&&s.classList.remove(e),n&&(n.classList.add(e),n.scrollIntoView({block:"nearest"}))}this._selected=n,this._selectedIndex=n?e:-1,t&&(this._triggerElem.value=n?this._options.getItemText(this.getSelectedItem()):this._lastAsTyped)}_findTargetItem(e){const t=v(this._menuContent,e);return Array.prototype.indexOf.call(this._menuContent.children,t)}_getNext(e){const t=this._items.get().length+1,n=(this._selectedIndex+e+t)%t;return n===t-1?-1:n}async _updateChoices(e,t){this._lastAsTyped=e;const n=await this._options.search(e);let s;this._highlightFunc=n.highlightFunc,this._items.set(n.items),this._popper.forceUpdate(),this._mouseOver.reset(),s=t?t(this._items.get()):e?n.selectIndex:-1,this._setSelected(s,!1)}}const f={placement:"bottom-start",modifiers:[c(((e,t)=>{for(var n in t||(t={}))u.call(t,n)&&h(e,n,t[n]);if(m)for(var n of m(t))p.call(t,n)&&h(e,n,t[n]);return e})({},l.Z),d({options:{padding:4}})),{name:"applyMaxSize",enabled:!0,phase:"beforeWrite",requires:["maxSize"],fn({state:e}){const{height:t}=e.modifiersData.maxSize;Object.assign(e.styles.popper,{maxHeight:`${Math.max(160,t)}px`})}},{name:"computeStyles",options:{gpuAcceleration:!1}}]};function v(e,t){for(;t&&t.parentElement!==e;)t=t.parentElement;return t}function x(e,t){let n;function s(t,s){n&&n.dispose(),n=i.dom.onElem(e,t,s)}function o(){s("mousemove",((e,n)=>{s("mouseover",t),t(e,n)}))}return o(),{reset:o}}const y=(0,i.styled)("div","\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  outline: none;\n")},61217:(e,t,n)=>{n.r(t),n.d(t,{copyToClipboard:()=>o});const s=(0,n(11527).get)("document","window");async function o(e){if(s.window.navigator&&s.window.navigator.clipboard&&s.window.navigator.clipboard.writeText)try{return void await s.window.navigator.clipboard.writeText(e)}catch(e){}const t=s.document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-10000px",s.document.body.appendChild(t);const n=s.document.getSelection().rangeCount>0&&s.document.getSelection().getRangeAt(0);t.select(),s.document.execCommand("copy"),s.document.body.removeChild(t),n&&(s.document.getSelection().removeAllRanges(),s.document.getSelection().addRange(n))}},80864:(e,t,n)=>{n.r(t),n.d(t,{setTestState:()=>o});const s=(0,n(11527).get)("window");function o(e){"testGrist"in s.window||(s.window.testGrist={}),Object.assign(s.window.testGrist,e)}},19058:(e,t,n)=>{n.d(t,{KA:()=>u,ND:()=>h,T7:()=>r,XL:()=>a,bE:()=>v,dg:()=>b,fe:()=>f,gE:()=>m,hS:()=>p,j$:()=>g,rk:()=>c,tE:()=>d});var s=n(29922),o=n(7454),i=n(18099),l=n(21467);const r=(0,i.styled)("div","\n  display: flex;\n  width: 460px;\n  min-height: 64px;\n  margin: 0 auto;\n  padding: 12px 0;\n"),a=(0,i.styled)("div",`\n  width: 40px;\n  height: 40px;\n  margin: 0 4px;\n  border-radius: 20px;\n  background-color: ${s.colors.lightGreen};\n  background-size: cover;\n\n  .${r.className}-removed & {\n    opacity: 0.4;\n  }\n`),c=(0,i.styled)("div",`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  margin: 2px 12px;\n  flex: 1 1 0;\n  min-width: 0px;\n  font-size: ${s.vars.mediumFontSize};\n\n  .${r.className}-removed & {\n    opacity: 0.4;\n  }\n`),d=(0,i.styled)("span",`\n  font-weight: bold;\n  color: ${s.theme.text};\n  padding: 2px 0;\n\n  .${l.cssMenuItem.className}-sel & {\n    color: ${s.theme.menuItemSelectedFg};\n  }\n`),m=(0,i.styled)("span",`\n  color: ${s.theme.lightText};\n  /* the following just undo annoying bootstrap styles that apply to all labels */\n  margin: 0px;\n  font-weight: normal;\n  padding: 2px 0;\n  white-space: nowrap;\n\n  .${l.cssMenuItem.className}-sel & {\n    color: ${s.theme.menuItemSelectedFg};\n  }\n`),u=(0,i.styled)("span",`\n  color: ${s.theme.lightText};\n  /* the following just undo annoying bootstrap styles that apply to all labels */\n  margin: 0px;\n  font-weight: normal;\n  padding: 2px 0;\n  white-space: nowrap;\n\n  .${l.cssMenuItem.className}-sel & {\n    color: ${s.theme.menuItemSelectedFg};\n  }\n`),p=(0,i.styled)("span",`\n  color: ${s.theme.errorText};\n  /* the following just undo annoying bootstrap styles that apply to all labels */\n  margin: 0px;\n  font-weight: normal;\n  padding: 2px 0;\n  white-space: nowrap;\n\n  .${l.cssMenuItem.className}-sel & {\n    color: ${s.theme.menuItemSelectedFg};\n  }\n`),h=(0,i.styled)("div","\n  width: 16px;\n  height: 16px;\n  cursor: pointer;\n\n  &-disabled {\n    opacity: 0.3;\n    cursor: default;\n  }\n"),b=(0,i.styled)(o.icon,`\n  background-color: ${s.theme.lightText};\n  margin: 12px 0;\n`),g=(0,i.styled)("div",`\n  position: relative;\n  display: flex;\n  height: 42px;\n  padding: 0 3px;\n  margin: 16px 63px;\n  border: 1px solid ${s.theme.inputBorder};\n  border-radius: 3px;\n  font-size: ${s.vars.mediumFontSize};\n  outline: none;\n\n  &-green {\n    border: 1px solid ${s.theme.inputValid};\n  }\n`),f=(0,i.styled)(i.input,`\n  color: ${s.theme.inputFg};\n  background-color: ${s.theme.inputBg};\n  flex: 1 1 0;\n  font-size: ${s.vars.mediumFontSize};\n  font-family: ${s.vars.fontFamily};\n  outline: none;\n  border: none;\n\n  &::placeholder {\n    color: ${s.theme.inputPlaceholderFg};\n  }\n`),v=(0,i.styled)(o.icon,`\n  margin: 12px 8px 12px 13px;\n  background-color: ${s.theme.lightText};\n`)},30735:(e,t,n)=>{n.r(t),n.d(t,{ACMemberEmail:()=>xe,UserManager:()=>ve,showUserManagerModal:()=>fe});var s=n(64978),o=n(83277),i=n(51503),l=n(18099),r=n(11104),a=n(61217),c=n(80864),d=n(20742),m=n(11187),u=n(29922),p=n(7454),h=n(91033),b=n(1370);function g(e,t){const n=(t.isOrg?t.orgUserSelectOptions:t.userSelectOptions).filter((e=>(0,i.QS)(e.value)));return _((0,b.menu)((()=>[l.dom.forEach(n,(t=>(0,b.menuItem)((()=>e.set(t.value)),t.label,(0,u.testId)("um-role-option"))))])),l.dom.text((t=>{const s=n.find((n=>t(e)===n.value));return s?s.label:""})),w("Collapse"),(0,u.testId)("um-role-select"))}function f(e,t,...n){return A(e,{onInput:!0,isValid:t},{placeholder:"Enter one email address per line"},l.dom.on("change",(e=>t.set(!0))),...n)}const v=(0,l.styled)(d.cssModalTitle,`\n  margin: 40px 64px 0 64px;\n\n  @media ${u.mediaXSmall} {\n    & {\n      margin: 16px;\n    }\n  }\n`),x=(0,l.styled)("span","\n  margin: 13px 63px 42px;\n"),y=(0,l.styled)("span",`\n  margin: 0 63px;\n  color: ${u.theme.errorText};\n`),_=(0,l.styled)("span",`\n  display: inline-flex;\n  font-size: ${u.vars.mediumFontSize};\n  color: ${u.theme.controlFg};\n  cursor: pointer;\n`),w=(0,l.styled)(p.icon,`\n  margin-top: 1px;\n  background-color: ${u.theme.controlFg};\n`),I=(0,l.styled)("div",`\n  display: flex;\n  flex-direction: column;\n  width: 600px;\n  font-size: ${u.vars.mediumFontSize};\n`),$=(0,l.styled)(I,`\n  height: 374px;\n  border-bottom: 1px solid ${u.theme.modalBorderDark};\n`),A=(0,l.styled)(h.J7,`\n  margin: 16px 63px;\n  padding: 12px 10px;\n  border-radius: 3px;\n  resize: none;\n  border: 1px solid ${u.theme.inputBorder};\n  color: ${u.theme.inputFg};\n  background-color: ${u.theme.inputBg};\n  flex: 1 1 0;\n  font-size: ${u.vars.mediumFontSize};\n  font-family: ${u.vars.fontFamily};\n  outline: none;\n\n  &::placeholder {\n    color: ${u.theme.inputPlaceholderFg};\n  }\n`);var S=n(70387),T=n(84462),C=n(6632),D=n(19058),M=n(18222),O=n(21467);const E=(0,S.makeT)("ACUserManager");const k=(0,l.styled)(D.tE,`\n  .${T.H.className}.selected & {\n    color: ${u.theme.menuItemSelectedFg};\n  }\n`),P=(0,l.styled)(D.gE,`\n  .${T.H.className}.selected & {\n    color: ${u.theme.menuItemSelectedFg};\n  }\n`),F=(0,l.styled)("span",`\n  color: ${u.theme.autocompleteMatchText};\n  .${T.H.className}.selected & {\n    color: ${u.theme.autocompleteSelectedMatchText};\n  }\n`),z=(0,l.styled)(M._s,`\n  background-color: ${u.colors.lightGreen};\n  margin: auto 0;\n\n  &-invalid {\n    background-color: ${u.colors.mediumGrey};\n  }\n\n  .${O.cssMenuItem.className}-sel & {\n    background-color: ${u.theme.menuItemIconSelectedFg};\n    color: ${u.theme.menuItemSelectedBg};\n  }\n`);var R,U,N=n(92769),B=n(3988),j=n(49668);function V(e){return e.toLowerCase()}class L{constructor(e,t,n={}){this._product=e,this._state=t,this._options=n,this._features=null!=(U=null==(R=this._product)?void 0:R.features)?U:{},this._supportEmail=this._options.supportEmail}updateState(e){this._state=e}annotateChanges(e){const t=this._features,n={hasTeam:!this._product||(0,j.F)(this._product.name),users:new Map};if(t.maxSharesPerDocPerRole||t.maxSharesPerWorkspace)return n;const s=t.maxSharesPerDoc;let o=0;const i=e=>{const t={isMember:e.isMember};return e.isSupport?{isSupport:!0}:(!t.isMember&&e.access&&(o++,t.collaboratorLimit={at:o,top:s}),t)},l=new Set(Object.entries((null==e?void 0:e.users)||{}).filter((([,e])=>null===e)).map((([e])=>V(e))));for(const e of this._state.users)l.has(e.email)||(e.isMember||e.access)&&n.users.set(e.email,i(e));const r=new Set(Object.entries((null==e?void 0:e.users)||{}).filter((([,e])=>null!==e)).map((([e])=>V(e))));for(const e of r){const t=n.users.get(e)||i({email:e,isMember:!1,isSupport:Boolean(""!==e.trim()&&e===this._supportEmail),access:"<set>"});n.users.set(e,t)}return n}}var H,G,W,K,Y,X,J=n(36322),q=n(58375),Q=Object.defineProperty,Z=Object.defineProperties,ee=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,ne=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable,oe=(e,t,n)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ie=(e,t)=>{for(var n in t||(t={}))ne.call(t,n)&&oe(e,n,t[n]);if(te)for(var n of te(t))se.call(t,n)&&oe(e,n,t[n]);return e},le=(e,t)=>Z(e,ee(t));const re=n(2278),ae=(0,S.makeT)("UserManagerModel");class ce extends l.Disposable{constructor(e,t,n){if(super(),this.initData=e,this.resourceType=t,this._options=n,this.userSelectOptions=[{value:i.vP,label:ae("Owner")},{value:i.Uw,label:ae("Editor")},{value:i.ad,label:ae("Viewer")}],this.orgUserSelectOptions=[{value:i.vP,label:ae("Owner")},{value:i.Uw,label:ae("Editor")},{value:i.ad,label:ae("Viewer")},{value:i.Dl,label:ae("No Default Access")}],this.inheritSelectOptions=[{value:i.vP,label:ae("In Full")},{value:i.Uw,label:ae("View & Edit")},{value:i.ad,label:ae("View Only")},{value:null,label:ae("None")}],this.publicUserSelectOptions=[{value:i.Uw,label:ae("Editor")},{value:i.ad,label:ae("Viewer")}],this.activeUser=null!=(H=this._options.activeUser)?H:null,this.resource=null!=(G=this._options.resource)?G:null,this.maxInheritedRole=(0,l.observable)(this.initData.maxInheritedRole||null),this.publicMember=this._buildPublicMember(),this.membersEdited=this.autoDispose((0,l.obsArray)(this._buildAllMembers())),this.annotations=this.autoDispose((0,l.observable)({users:new Map})),this.isPersonal=null!=(W=this.initData.personal)&&W,this.isPublicMember=null!=(K=this.initData.public)&&K,this.isOrg="organization"===this.resourceType,this.gristDoc=null!=(X=null==(Y=this._options.docPageModel)?void 0:Y.gristDoc.get())?X:null,this.isAnythingChanged=this.autoDispose((0,l.computed)((e=>{const t=t=>t.isNew||t.isRemoved||e(t.access)!==t.origAccess,n=!this.isOrg&&e(this.maxInheritedRole)!==this.initData.maxInheritedRole;return re(e(this.membersEdited),t)||n||!!this.publicMember&&t(this.publicMember)}))),this.isSelfRemoved=this.autoDispose((0,l.computed)((e=>re(e(this.membersEdited),(e=>{var t;return e.isRemoved&&e.email===(null==(t=this.activeUser)?void 0:t.email)}))))),this._options.appModel){const t=this._options.appModel.currentProduct,{supportEmail:n}=(0,J.getGristConfig)();this._shareAnnotator=new L(t,e,{supportEmail:n})}this.annotate()}reset(){this.membersEdited.set(this._buildAllMembers()),this.annotate()}async reloadAnnotations(){if(!this._options.reload||!this._shareAnnotator)return;const e=await this._options.reload();this._shareAnnotator.updateState(e),this.annotate()}async save(e,t){"organization"===this.resourceType?await e.updateOrgPermissions(t,this.getDelta()):"workspace"===this.resourceType?await e.updateWorkspacePermissions(t,this.getDelta()):"document"===this.resourceType&&await e.updateDocPermissions(t,this.getDelta())}add(e,t){e=V(e);const n=this.membersEdited.get(),s=n.findIndex((t=>t.email===e)),o=s>-1?n[s]:null;if(o&&o.isRemoved)this.membersEdited.splice(s,1,le(ie({},o),{isRemoved:!1}));else if(o){const e=o.effectiveAccess.get();if(e&&e!==i._5)throw new Error("This user is already in the list");o.access.set(t),o.isNew=!0}else{const n=this._buildEditableMember({id:-1,email:e,name:"",access:t,parentAccess:null});n.isNew=!0,this.membersEdited.push(n)}this.annotate()}remove(e){const t=this.membersEdited.get().indexOf(e);e.isNew?this.membersEdited.splice(t,1):this.membersEdited.splice(t,1,le(ie({},e),{isRemoved:!0})),this.annotate()}isActiveUser(e){var t;return e.email===(null==(t=this.activeUser)?void 0:t.email)}annotate(){this._shareAnnotator&&this.annotations.set(this._shareAnnotator.annotateChanges(this.getDelta({silent:!0})))}getDelta(e){const t={users:{}};if("organization"!==this.resourceType){const e=this.maxInheritedRole.get();this.initData.maxInheritedRole!==e&&(t.maxInheritedRole=e)}const n=[...this.membersEdited.get()];this.publicMember&&n.push(this.publicMember);for(const s of n){const n=s.access.get();if(i.LL(n))(s.isNew||s.isRemoved||s.origAccess!==n)&&(t.users[s.email]=s.isRemoved?null:n);else if(!(null==e?void 0:e.silent))throw new Error(`Cannot update user to invalid role ${n}`)}return t}_buildAllMembers(){let e=this.initData.users;const t=this.publicMember;return t&&(e=e.filter((e=>e.email!==t.email))),e.map((e=>this._buildEditableMember({id:e.id,email:e.email,name:e.name,picture:e.picture,access:e.access,parentAccess:e.parentAccess||null,isTeamMember:e.isMember})))}_buildPublicMember(){const e=(window.gristConfig||{}).supportAnon?q._J:"document"===this.resourceType?q.CF:null;if(!e)return null;const t=this.initData.users.find((t=>t.email===e));return this._buildEditableMember({id:t?t.id:-1,email:e,name:"",access:t?t.access:null,parentAccess:t&&t.parentAccess||null})}_buildEditableMember(e){var t;const n=l.Observable.create(this,e.access);let s;if(e.email===(null==(t=this.activeUser)?void 0:t.email)){const t=i.Vf((0,q.U9)(e,this.initData));s=l.Computed.create(this,(e=>t))}else s=l.Computed.create(this,this.maxInheritedRole,((t,n)=>i.VJ(e.parentAccess,n)));const o=l.Computed.create(this,(e=>i.ub(e(n),e(s))));return o.onWrite((e=>{const t=s.get(),o=i.ub(e,t)!==t;n.set(o?e:null)})),{id:e.id,email:e.email,name:e.name,picture:e.picture,access:n,parentAccess:e.parentAccess||null,inheritedAccess:s,effectiveAccess:o,origAccess:e.access,isNew:!1,isRemoved:!1,isTeamMember:e.isTeamMember}}}function de(e){return"workspace"===e?"organization":"document"===e?"workspace":null}var me=n(7485),ue=n(98987),pe=n(8881),he=n(4425),be=n(99002);const ge=n(68525);function fe(e,t){const n=(0,l.observable)(null),s=async function(e){const t=await e.permissionData;return new ce(t,e.resourceType,ge(e,["activeUser","reload","appModel","docPageModel","resource"]))}(t).then((e=>n.set(e))).catch(N.reportError);return(0,o.isLongerThan)(s,400).then((e=>e&&n.set("slow"))).catch((()=>{})),function(e,t,n){return(0,d.modal)((s=>[{style:"padding: 0;"},n.showAnimation?l.dom.cls(d.cssAnimatedModal.className):null,l.dom.domComputed(e,(e=>{if(!e)return null;if("slow"===e)return Ie((0,be.M)());const o=e.isPersonal?_e:we;return[Ne((i=n.resourceType,r=n.resource,a=e.isPersonal,"organization"===i?a?"Your role for this team site":["Manage members of team site",r?Re(`${r.name} (`,Ue(`${r.domain}.getgrist.com`),")"):null]:a?`Your role for this ${i}`:`Invite people to ${i}`),"document"!==n.resourceType||e.isPersonal&&!e.isPublicMember?null:ye(n.linkToCopy,$e.cls("-header")),(0,u.testId)("um-header")),(0,d.cssModalBody)(o(new ve(e,ge(n,"linkToCopy","docPageModel","appModel","prompt","resource")).buildDom())),(0,d.cssModalButtons)({style:"margin: 32px 64px; display: flex;"},e.isPublicMember?null:(0,m.bigPrimaryButton)("Confirm",l.dom.boolAttr("disabled",(t=>!t(e.isAnythingChanged))),l.dom.on("click",(()=>t(s))),(0,u.testId)("um-confirm")),(0,m.bigBasicButton)(e.isPublicMember?"Close":"Cancel",l.dom.on("click",(()=>s.close())),(0,u.testId)("um-cancel")),"document"===e.resourceType&&e.gristDoc&&!e.isPersonal?(0,pe.withInfoTooltip)((0,he.Y3)({href:(0,B.urlState)().makeUrl({docPage:"acl"})},l.dom.text((t=>t(e.isAnythingChanged)?"Save & ":"")),"Open Access Rules",l.dom.on("click",(e=>(e.preventDefault(),t(s).then((()=>(0,B.urlState)().pushUrl({docPage:"acl"})))))),(0,u.testId)("um-open-access-rules")),me.D.openAccessRules(),{domArgs:[ze.cls("")]}):null,(0,u.testId)("um-buttons"))];var i,r,a}))]))}(n,(async function(s){const o=n.get();if(!o||"slow"===o)return void s.close();const i=async()=>{var n;try{const i=o.isAnythingChanged.get();i&&await o.save(e,t.resourceId),await(null==(n=t.onSave)?void 0:n.call(t,o.isPersonal)),s.close(),o.isPersonal&&i&&window.location.reload()}catch(e){(0,N.reportError)(e)}};if(o.isSelfRemoved.get()){const e="organization"===(l=o.resourceType)?"team site":l;(0,d.confirmModal)(`You are about to remove your own access to this ${e}`,"Remove my access",i,`Once you have removed your own access, you will not be able to get it back without assistance from someone else with sufficient access to the ${e}.`)}else i().catch(N.reportError);var l}),t)}class ve extends l.Disposable{constructor(e,t){super(),this._model=e,this._options=t}buildDom(){return this._model.isPublicMember?this._buildSelfPublicAccessDom():this._model.isPersonal?this._buildSelfAccessDom():[this.autoDispose(new xe(this._onAdd.bind(this),this._model.membersEdited.get(),this._options.prompt)).buildDom(),this._buildOptionsDom(),this._dom=(0,ue.a)((0,u.testId)("um-members"),this._buildPublicAccessMember(),l.dom.forEach(this._model.membersEdited,(e=>this._buildMemberDom(e))))]}_onAddOrEdit(e,t){const n=this._model.membersEdited.get().find((t=>t.email===e));n?n.access.set(t):this._onAdd(e,t)}_onAdd(e,t){var n;this._model.add(e,t),null==(n=Array.from(this._dom.querySelectorAll(".member-email")).find((t=>t.textContent===e)))||n.scrollIntoView()}_buildOptionsDom(){const e=this._model.publicMember;let t;return(0,l.dom)("div",Te((0,p.icon)("AddUser"),Ce("Invite multiple"),l.dom.on("click",(e=>function(e,t,n){const s=l.Observable.create(e,""),o=l.Observable.create(e,i.ad),r=l.Observable.create(e,!0),a=(0,l.computed)((e=>Boolean(e(s)&&e(o)&&e(r))));return(0,d.modal)((e=>[{style:"padding: 0;"},l.dom.cls(d.cssAnimatedModal.className),v("Invite Users",(0,u.testId)("um-header")),(0,d.cssModalBody)($(f(s,r),l.dom.maybe((e=>!e(r)),(()=>y("At least one email is invalid"))),x((0,l.dom)("span","Access: "),g(o,t)))),(0,d.cssModalButtons)({style:"margin: 32px 64px; display: flex;"},(0,m.bigPrimaryButton)("Confirm",l.dom.boolAttr("disabled",(e=>!e(a))),l.dom.on("click",(()=>(e=>{const t=s.get().split("\n").map((e=>e.trim().toLowerCase())).filter((e=>""!==e)),i=o.get();t.some((e=>!function(e){return/\S+@\S+\.\S+/.test(e)}(e)))?r.set(!1):(t.forEach((e=>n(e,i))),e.close())})(e))),(0,u.testId)("um-confirm")),(0,m.bigBasicButton)("Cancel",l.dom.on("click",(()=>e.close())),(0,u.testId)("um-cancel")))]))}(this,this._model,((e,t)=>{this._onAddOrEdit(e,t)}))))),Se(this._model.isOrg?null:(0,l.dom)("span",{style:"float: left;"},(0,l.dom)("span","Inherit access: "),this._inheritRoleSelector()),e?(0,l.dom)("span",{style:"float: right;"},Oe("PublicFilled"),(0,l.dom)("span","Public access: "),De((0,b.menu)((()=>(null==t||t.close(),[(0,b.menuItem)((()=>e.access.set(i.ad)),"On",(0,u.testId)("um-public-option")),(0,b.menuItem)((()=>e.access.set(null)),"Off",l.dom.cls("disabled",(t=>null!==t(e.inheritedAccess))),(0,u.testId)("um-public-option")),l.dom.maybe((t=>null!==t(e.inheritedAccess)),(()=>(0,b.menuText)(`Public access inherited from ${de(this._model.resourceType)}. To remove, set 'Inherit access' option to 'None'.`)))]))),l.dom.text((t=>t(e.effectiveAccess)?"On":"Off")),Fe("Collapse"),(0,u.testId)("um-public-access")),(0,pe.hoverTooltip)((e=>(t=e,"Allow anyone with the link to open.")))):null))}_buildMemberDom(e){const t=l.Computed.create(null,(t=>this._model.isPersonal?!e.origAccess:Boolean(this._model.isActiveUser(e)||t(e.inheritedAccess))));return(0,l.dom)("div",l.dom.autoDispose(t),l.dom.maybe((t=>t(e.effectiveAccess)&&t(e.effectiveAccess)!==i._5),(()=>(0,D.T7)(D.T7.cls("-removed",e.isRemoved),(0,D.XL)((0,M.O_)(function(e){return{id:e.id,name:e.name,email:e.email,picture:e.picture}}(e),"large")),(0,D.rk)((0,D.tE)(e.name||e.email,e.email?l.dom.cls("member-email"):null,(0,u.testId)("um-member-name")),e.name?(0,D.gE)(e.email,l.dom.cls("member-email"),(0,u.testId)("um-member-email")):null,this._model.isPersonal?this._buildSelfAnnotationDom(e):this._buildAnnotationDom(e)),e.isRemoved?null:this._memberRoleSelector(e.effectiveAccess,e.inheritedAccess,this._model.isActiveUser(e)),(0,D.ND)(e.isRemoved?ke("Undo",(0,u.testId)("um-member-undo")):(0,D.dg)("Remove",(0,u.testId)("um-member-delete")),D.ND.cls("-disabled",t),l.dom.on("click",(()=>t.get()||(e.isRemoved?this._model.add(e.email,e.access.get()):this._model.remove(e))))),(0,u.testId)("um-member")))))}_buildAnnotationDom(e){return l.dom.domComputed(this._model.annotations,(t=>{const n=t.users.get(e.email);if(!n)return null;if(n.isSupport)return(0,D.KA)("Grist support");if(n.isMember&&t.hasTeam)return(0,D.KA)("Team member");const i=t.hasTeam?"guest":"free collaborator",r=n.collaboratorLimit;if(!r||!r.top)return null;const a=[];return r.at<=r.top?a.push((0,D.KA)(`${r.at} of ${r.top} ${i}s`)):a.push((0,D.hS)(`${(0,o.capitalizeFirstWord)(i)} limit exceeded`)),t.hasTeam?a.push((0,he.Y3)({href:(0,B.urlState)().makeUrl({manageUsers:!0})},l.dom.on("click",(t=>{this._options.appModel&&(t.preventDefault(),async function(e,t,n){await(0,B.urlState)().pushUrl({manageUsers:!1});const s=e.currentValidUser,o=e.currentOrg;if(o){const i=e.api;fe(i,{permissionData:i.getOrgAccess(o.id),activeUser:s,resourceType:"organization",resourceId:o.id,resource:o,onSave:t,prompt:n,showAnimation:!0})}}(this._options.appModel,(()=>this._model.reloadAnnotations()),{email:e.email}).catch(N.reportError))})),`Add ${e.name||"member"} to your team`)):r.at>=r.top&&a.push((0,he.Y3)({href:s.PH.plans,target:"_blank"},"Create a team to share with more people")),a}))}_buildSelfAnnotationDom(e){return l.dom.domComputed(this._model.annotations,(t=>{const n=t.users.get(e.email);if(!n)return null;let s;return s=n.isSupport?"Grist support":n.isMember&&t.hasTeam?"Team member":t.hasTeam?"Outside collaborator":"Collaborator",(0,D.KA)(s,(0,u.testId)("um-member-annotation"))}))}_buildPublicAccessMember(){const e=this._model.publicMember;return e?(0,l.dom)("div",l.dom.maybe((t=>Boolean(t(e.effectiveAccess))),(()=>(0,D.T7)(Me("PublicFilled"),(0,D.rk)((0,D.tE)("Public Access"),(0,D.gE)("Anyone with link ",ye(this._options.linkToCopy))),this._memberRoleSelector(e.effectiveAccess,e.inheritedAccess,!1,this._model.publicUserSelectOptions),(0,D.ND)((0,D.dg)("Remove",(0,u.testId)("um-member-delete")),l.dom.on("click",(()=>e.access.set(null)))),(0,u.testId)("um-public-member"))))):null}_buildSelfPublicAccessDom(){var e,t,n;const s=null==(e=this._options.resource)?void 0:e.access,o=null==(t=this._model.publicUserSelectOptions.find((e=>e.value===s)))?void 0:t.label,i=this._model.activeUser,r=null!=(n=null==i?void 0:i.name)?n:"Anonymous";return(0,l.dom)("div",(0,D.T7)(i?(0,D.XL)((0,M.O_)(i,"large")):Me("PublicFilled"),(0,D.rk)((0,D.tE)(r,(0,u.testId)("um-member-name")),(null==i?void 0:i.email)?(0,D.gE)(i.email):null,Be((0,l.dom)("span","Public access",(0,u.testId)("um-member-annotation")),Ee("PublicFilled"))),Pe(null!=o?o:"Guest",Fe("Collapse"),l.dom.cls("disabled"),(0,u.testId)("um-member-role")),(0,u.testId)("um-member")),(0,u.testId)("um-members"))}_buildSelfAccessDom(){return(0,l.dom)("div",l.dom.domComputed(this._model.membersEdited,(e=>e[0]?this._buildMemberDom(e[0]):null)),(0,u.testId)("um-members"))}_memberRoleSelector(e,t,n,s){const o=s||(this._model.isOrg?this._model.orgUserSelectOptions:this._model.userSelectOptions);return Pe(this._model.isPersonal?null:(0,b.menu)((()=>[l.dom.forEach(o,(s=>(0,b.menuItem)((()=>n||e.set(s.value)),s.label,l.dom.text((e=>e(t)&&e(t)===s.value&&!n?" (inherited)":"")),l.dom.cls("disabled",(e=>i.ub(s.value,e(t))!==s.value)),(0,u.testId)("um-role-option")))),n?(0,b.menuText)("User may not modify their own access."):null,l.dom.maybe((e=>e(t)&&!n),(()=>(0,b.menuText)(`User inherits permissions from ${de(this._model.resourceType)}. To remove, set 'Inherit access' option to 'None'.`))),l.dom.maybe((t=>!this._model.isOrg&&t(e)===i._5),(()=>(0,b.menuText)(`User has view access to ${this._model.resourceType} resulting from manually-set access to resources inside. If removed here, this user will lose access to resources inside.`))),this._model.isOrg?(0,b.menuText)("No default access allows access to be granted to individual documents or workspaces, rather than the full team site."):null])),l.dom.text((t=>{const n=o.find((n=>t(e)===n.value));return n?n.label:"Guest"})),Fe("Collapse"),this._model.isPersonal?l.dom.cls("disabled"):null,(0,u.testId)("um-member-role"))}_inheritRoleSelector(){const e=this._model.maxInheritedRole,t=this._model.inheritSelectOptions;return De((0,b.menu)((()=>[l.dom.forEach(t,(t=>(0,b.menuItem)((()=>e.set(t.value)),t.label,(0,u.testId)("um-role-option"))))])),l.dom.text((n=>{const s=t.find((t=>n(e)===t.value));return s?s.label:""})),Fe("Collapse"),(0,u.testId)("um-max-inherited-role"))}}class xe extends l.Disposable{constructor(e,t,n){super(),this._onAdd=e,this._members=t,this._prompt=n,this._email=this.autoDispose((0,l.observable)("")),n&&this._email.set(n.email)}buildDom(){const e=this._members.filter((e=>e.isTeamMember)).map((e=>function(e){return{value:e.email,label:e.email,cleanText:(0,r.normalizeText)(e.email),email:e.email,name:e.name,picture:null==e?void 0:e.picture,id:e.id}}(e)));return function(e,t,...n){const{acIndex:s,emailObs:o,save:i,prompt:a}=t,c=l.Holder.create(e);let d;const m=l.Observable.create(e,!0),p=()=>c.isEmpty()&&C.Autocomplete.create(c,d,x),h=()=>c.clear(),g=()=>{h(),o.set(""),d.value=o.get(),d.focus()},f=()=>{var e;const t=null==(e=c.get())?void 0:e.getSelectedItem();t&&o.set(t.value),d.setCustomValidity(""),m.set(d.checkValidity());const n=(null==t?void 0:t.value)||o.get();try{n&&m.get()&&(i(o.get()),g())}catch(e){d.setCustomValidity(e.message)}finally{d.reportValidity()}},v=(0,l.computed)((e=>Boolean(e(o)&&e(m)))),x={attach:null,menuCssClass:`${b.menuCssClass} test-acselect-dropdown`,search:e=>(async(e,t)=>{const n=(0,r.normalizeText)(t),s=e.items.filter((e=>e.cleanText.includes(n))).sort(((e,t)=>e.cleanText.localeCompare(t.cleanText)));if(e.items=s,!e.items.length&&n){const s={value:t,cleanText:n,name:"",email:"",isNew:!0,label:t,id:0};e.items.push(s)}return e})(s.search(e),e),renderItem:(e,t)=>(null==e?void 0:e.isNew)?(0,T.H)((0,D.T7)(z("+",M._s.cls("-large"),z.cls("-invalid",(e=>!e(v)))),(0,D.rk)(k(E("Invite new member")),P(l.dom.text((e=>E("We'll email an invite to {{email}}",{email:e(o)}))))),(0,u.testId)("um-add-email"))):(0,T.H)((0,D.T7)((0,D.XL)((0,M.O_)(e,"large")),(0,D.rk)(k(e.name,(0,u.testId)("um-member-name")),P((0,r.buildHighlightedDom)(e.label,t,F))))),getItemText:e=>e.value,onClick:f},y=(0,D.j$)((0,D.bE)("Mail"),d=(0,D.fe)(o,{onInput:!0,isValid:m},{type:"email",placeholder:E("Enter email address")},l.dom.on("input",p),l.dom.on("focus",p),l.dom.on("click",p),l.dom.on("blur",h),l.dom.onKeyDown({Escape:g,Enter:()=>{c.isEmpty()?p():f()},ArrowDown:p,Tab:f})),D.j$.cls("-green",v),...n);return e.autoDispose(o.addListener((()=>d.setCustomValidity("")))),a&&setTimeout((()=>d.focus()),0),y}(this,{acIndex:new r.ACIndexImpl(e),emailObs:this._email,save:this._handleSave.bind(this),prompt:this._prompt},(0,u.testId)("um-member-new"))}_handleSave(e){this._onAdd(e,i.ad)}}function ye(e,...t){return e&&$e(Ae("Copy"),"Copy Link",l.dom.on("click",((t,n)=>async function(e,t){await(0,a.copyToClipboard)(t),(0,c.setTestState)({clipboard:t}),(0,pe.showTransientTooltip)(e,"Link copied to clipboard",{key:"copy-doc-link"})}(n,e))),(0,u.testId)("um-copy-link"),...t)}const _e=(0,l.styled)("div",`\n  display: flex;\n  flex-direction: column;\n  width: 600px;\n  font-size: ${u.vars.mediumFontSize};\n`),we=(0,l.styled)(_e,`\n  height: 374px;\n  border-bottom: 1px solid ${u.theme.modalBorderDark};\n`),Ie=(0,l.styled)("div","\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 32px;\n"),$e=(0,l.styled)(m.basicButton,"\n  border: none;\n  font-weight: normal;\n  padding: 0 8px;\n  &-header {\n    float: right;\n    margin-top: 8px;\n  }\n"),Ae=(0,l.styled)(p.icon,"\n  margin-right: 4px;\n  margin-top: -2px;\n"),Se=(0,l.styled)("div",`\n  font-size: ${u.vars.mediumFontSize};\n  margin: 0 63px 23px 63px;\n`),Te=(0,l.styled)("div",`\n  margin: 0 63px 12px 63px;\n  font-size: ${u.vars.mediumFontSize};\n  display: flex;\n  cursor: pointer;\n  color: ${u.theme.controlFg};\n  --icon-color: ${u.theme.controlFg};\n\n  &:hover {\n    color: ${u.theme.controlHoverFg};\n    --icon-color: ${u.theme.controlHoverFg};\n  }\n`),Ce=(0,l.styled)("span","\n  margin-left: 4px;\n"),De=(0,l.styled)("span",`\n  display: inline-flex;\n  font-size: ${u.vars.mediumFontSize};\n  color: ${u.theme.controlFg};\n  cursor: pointer;\n`),Me=(0,l.styled)(p.icon,`\n  width: 40px;\n  height: 40px;\n  margin: 0 4px;\n  --icon-color: ${u.theme.accentIcon};\n`),Oe=(0,l.styled)(Me,"\n  width: 16px;\n  height: 16px;\n  top: -2px;\n"),Ee=(0,l.styled)(p.icon,`\n  --icon-color: ${u.theme.accentIcon};\n`),ke=(0,l.styled)(p.icon,`\n  --icon-color: ${u.theme.controlSecondaryFg};\n  margin: 12px 0;\n`),Pe=(0,l.styled)("div",`\n  display: flex;\n  justify-content: flex-end;\n  font-size: ${u.vars.mediumFontSize};\n  color: ${u.theme.controlFg};\n  margin: 12px 24px;\n  cursor: pointer;\n\n  &.disabled {\n    opacity: 0.5;\n    cursor: default;\n  }\n`),Fe=(0,l.styled)(p.icon,`\n  margin-top: 1px;\n  background-color: ${u.theme.controlFg};\n`),ze=(0,l.styled)(he.Y3,"\n  align-self: center;\n  margin-left: auto;\n"),Re=(0,l.styled)("div",`\n  font-size: ${u.vars.largeFontSize};\n`),Ue=(0,l.styled)("span",`\n  color: ${u.theme.accentText};\n`),Ne=(0,l.styled)(d.cssModalTitle,`\n  margin: 40px 64px 0 64px;\n\n  @media ${u.mediaXSmall} {\n    & {\n      margin: 16px;\n    }\n  }\n`),Be=(0,l.styled)(D.gE,"\n  display: flex;\n  align-items: center;\n  gap: 8px;\n")},91033:(e,t,n)=>{n.d(t,{J7:()=>r,Y2:()=>l});var s=n(29922),o=n(18099);const i=(0,o.styled)("input",`\n  font-size: ${s.vars.mediumFontSize};\n  height: 48px;\n  line-height: 20px;\n  width: 100%;\n  padding: 14px;\n  border: 1px solid ${s.theme.inputBorder};\n  border-radius: 4px;\n  outline: none;\n  display: block;\n  color: ${s.theme.inputFg};\n  background-color: ${s.theme.inputBg};\n\n  &::placeholder {\n    color: ${s.theme.inputPlaceholderFg};\n  }\n\n  &[type=number] {\n    -moz-appearance: textfield;\n  }\n  &[type=number]::-webkit-inner-spin-button,\n  &[type=number]::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  &-invalid {\n    border: 1px solid ${s.theme.inputInvalid};\n  }\n\n  &-valid {\n    border: 1px solid ${s.theme.inputValid};\n  }\n`);function l(e,...t){return i(o.dom.prop("value",e),o.dom.on("input",((t,n)=>e.set(n.value))),...t)}function r(e,t,...n){const s=t.isValid;function i(t){e.set(t.value),s&&s.set(t.validity.valid)}return(0,o.dom)("textarea",...n,o.dom.prop("value",e),s?t=>o.dom.autoDisposeElem(t,(0,o.subscribe)(e,(e=>s.set(t.checkValidity())))):null,t.onInput?o.dom.on("input",((e,t)=>i(t))):null,o.dom.on("change",((e,t)=>i(t))))}},98987:(e,t,n)=>{n.d(t,{a:()=>o});var s=n(18099);function o(...e){const t=s.Observable.create(null,!0),n=s.Observable.create(null,!0);return l(s.dom.autoDispose(t),s.dom.autoDispose(n),(e=>{setTimeout((()=>n.set(i(e))),0)}),s.dom.on("scroll",((e,s)=>{t.set(function(e){return 0===e.scrollTop}(s)),n.set(i(s))})),s.dom.style("box-shadow",(e=>[e(t)?null:"inset 0 4px 6px 0 rgba(217,217,217,0.4)",e(n)?null:"inset 0 -4px 6px 0 rgba(217,217,217,0.4)"].filter((e=>e)).join(", "))),...e)}function i(e){return e.scrollTop>=e.scrollHeight-e.offsetHeight}const l=(0,s.styled)("div","\n  flex: 1 1 0;\n  width: 100%;\n  overflow-y: auto;\n")}}]);
//# sourceMappingURL=735.bundle.js.map